<div class="modal-header">
  <span  ng-click="showIframeInput=!showIframeInput"><h4 ng-if="showPatientId">{{patient.namn}}&nbsp;&nbsp;&nbsp;{{patient.id}} &nbsp;&nbsp; {{patient.alder}} år {{patient.konShow}}</h4></span>
  <h4 ng-if="!showPatientId">{{patient.alder}} år {{patient.konShow}}</h4>
  <span ng-if="showIframeInput"><input id="urlen" type="text" size="50" ng-model="visaIntygUrl.url" placholder="url att visa i iframe"><button ng-click="onShowIntyg()">visa iframe</button></span>
  <button class="btn btn-link close-button pull-right" ng-click="close();">Stäng patientvy</button>
</div>

<div class="modal-body">
  <div id="intyg-iframe" ng-if="intygurl">
    <iframe ng-src="{{intygurl}}" width="100%" height="400"></iframe>
  </div>
  <div rhs-spinner show-spinner="showSpinner" label="label.patienthistory.loading">


    <div ng-repeat="item in timeline">
      
      <!-- special case: gap between years that have sjukfall -->
      <div ng-if="!item.sjukfall" class="row year-gap">
        <div class="col-xs-1 history-timeline">
          <!-- gap dotted line -->
          <svg xmlns="http://www.w3.org/2000/svg" height="30" ng-attr-width="{{radius * 2 + 4}}" class="year-gap">
            <line ng-attr-x1="{{radius-4}}" y1="0" ng-attr-x2="{{radius+8}}" y2="0" stroke-width="4" />
            <line ng-attr-x1="{{radius+2}}" y1="0" ng-attr-x2="{{radius+2}}" y2="100%" stroke-width="2"
                  stroke-dasharray="2, 1" />
          </svg>

        </div>
        <div class="col-xs-11">&nbsp;</div>
      </div>

      <div ng-if="item.sjukfall" class="row">
        <rhs-patient-history-time-line-item history-item="item" index="$index" is-last="$last" on-select="onSelectSjukfall(item)"
                                            class="pull-left history-timeline">

        </rhs-patient-history-time-line-item>

        <rhs-patient-history-table history-item="item" index="$index" on-select="onSelectSjukfall(item)" on-show-intyg="onShowIntyg(intyg)"
                                   class="pull-left history-table"></rhs-patient-history-table>
      </div>
    </div>


    <div class="alert alert-danger" ng-if="errorMessageKey" ng-bind-html="errorMessageKey | message"></div>

  </div>

</div>
